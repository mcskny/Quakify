{"ast":null,"code":"import React,{useRef,useEffect,useState}from\"react\";import*as maptilersdk from\"@maptiler/sdk\";import\"@maptiler/sdk/dist/maptiler-sdk.css\";import\"./map.css\";import axios from'axios';import geojson from'./quakes.json';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MAPTILER_API_KEY=\"MTCoW3CI3wRY7K9lPnAI\";const getCityCountry=async coordinates=>{if(!coordinates)return\"\";const[lon,lat]=coordinates.split(',').map(c=>c.trim());try{const response=await fetch(\"https://api.maptiler.com/geocoding/\".concat(lon,\",\").concat(lat,\".json?key=\").concat(MAPTILER_API_KEY,\"&language=en\"));const data=await response.json();if(data.features&&data.features.length>0){var _context$find,_context$find2;const context=data.features[0].context||[];let city=((_context$find=context.find(c=>c.id.startsWith(\"place\")))===null||_context$find===void 0?void 0:_context$find.text)||\"\";let country=((_context$find2=context.find(c=>c.id.startsWith(\"country\")))===null||_context$find2===void 0?void 0:_context$find2.text)||\"\";// Sadece İngilizce harfler, rakamlar, boşluk ve virgül izin ver\ncity=city.replace(/[^A-Za-z0-9 ,.-]/g,\"\");country=country.replace(/[^A-Za-z0-9 ,.-]/g,\"\");if(city&&country)return\"\".concat(city,\", \").concat(country);let placeName=data.features[0].place_name||\"\";placeName=placeName.replace(/[^A-Za-z0-9 ,.-]/g,\"\");return placeName;}return\"\";}catch{return\"\";}};export default function Map(){const[quak,setQuak]=useState([]);const[markers,setMarkers]=useState([]);useEffect(()=>{const fetchData=async()=>{try{const response=await axios.get('https://quakify.mcskn.com/backend/api.php');setQuak(response.data);}catch(error){console.error('Error fetching data:',error);}};const fetchLocations=async()=>{const locs={};await Promise.all(quak.map(async quake=>{if(quake.coordinates){locs[quake.id]=await getCityCountry(quake.coordinates);}}));setLocations(locs);};if(quak.length>0)fetchLocations();fetchData();},[quak]);const mapContainer=useRef(null);const ist={lng:28.97709,lat:41.011467};const[zoom]=useState(1.5);maptilersdk.config.apiKey=\"MTCoW3CI3wRY7K9lPnAI\";useEffect(()=>{const map=new maptilersdk.Map({container:mapContainer.current,style:\"https://api.maptiler.com/maps/b89836a1-3239-4824-bf17-5aef32dc5664/style.json?key=MTCoW3CI3wRY7K9lPnAI\",center:[ist.lng,ist.lat],zoom:zoom});const newMarkers=quak.map(marker=>{const child=document.createElement(\"div\");child.className=\"marker\";child.textContent=marker.magnitude;child.style.textAlign=\"center\";child.style.margin=\"auto\";child.style.paddingTop=22+\"px\";child.style.color=\"white\";child.style.fontFamily=\"inter\";child.style.fontSize=\"15px\";child.style.alignItems=\"center\";if(marker.magnitude<5){setMarkerStyle(child,\"https://quakify.mcskn.com/Point.png\",20);}else if(marker.magnitude>=5&&marker.magnitude<7){setMarkerStyle(child,\"https://quakify.mcskn.com/Point.png\",45,13,\"12px\");}else{setMarkerStyle(child,\"https://quakify.mcskn.com/Point.png\",65);}child.addEventListener(\"mouseover\",function(){document.getElementById(\"info\").innerHTML=locations[quake.id]?locations[quake.id]:\"Yükleniyor...\"+\"    /    \"+marker.magnitude+\"   /   \"+marker.depth+\"km\";});child.addEventListener(\"mouseleave\",function(){document.getElementById(\"info\").innerHTML=\"\";});const newMarker=new maptilersdk.Marker({element:child}).setLngLat(marker.coordinates.split(\",\")).addTo(map);return newMarker;});setMarkers(newMarkers);return()=>{map.remove();};},[ist.lng,ist.lat,zoom,quak]);const setMarkerStyle=function(child,backgroundImage,width){let paddingTop=arguments.length>3&&arguments[3]!==undefined?arguments[3]:22;let fontSize=arguments.length>4&&arguments[4]!==undefined?arguments[4]:\"15px\";child.style.backgroundImage=\"url(\".concat(backgroundImage,\")\");child.style.width=\"\".concat(width,\"px\");child.style.height=\"\".concat(width,\"px\");child.style.paddingTop=\"\".concat(paddingTop,\"px\");child.style.fontSize=fontSize;};return/*#__PURE__*/_jsxs(\"div\",{className:\"map-wrap\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"info\",className:\"w-60 left-2 h-8  text-white inter-light mt-1 fixed z-20\"}),/*#__PURE__*/_jsx(\"div\",{ref:mapContainer,className:\"map\"})]});}","map":{"version":3,"names":["React","useRef","useEffect","useState","maptilersdk","axios","geojson","jsx","_jsx","jsxs","_jsxs","MAPTILER_API_KEY","getCityCountry","coordinates","lon","lat","split","map","c","trim","response","fetch","concat","data","json","features","length","_context$find","_context$find2","context","city","find","id","startsWith","text","country","replace","placeName","place_name","Map","quak","setQuak","markers","setMarkers","fetchData","get","error","console","fetchLocations","locs","Promise","all","quake","setLocations","mapContainer","ist","lng","zoom","config","apiKey","container","current","style","center","newMarkers","marker","child","document","createElement","className","textContent","magnitude","textAlign","margin","paddingTop","color","fontFamily","fontSize","alignItems","setMarkerStyle","addEventListener","getElementById","innerHTML","locations","depth","newMarker","Marker","element","setLngLat","addTo","remove","backgroundImage","width","arguments","undefined","height","children","ref"],"sources":["C:/Users/bain/Desktop/Quakify-main/quakifyapp/src/components/Map.jsx"],"sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\nimport * as maptilersdk from \"@maptiler/sdk\";\nimport \"@maptiler/sdk/dist/maptiler-sdk.css\";\nimport \"./map.css\";\nimport axios from 'axios';\nimport geojson from './quakes.json';\nconst MAPTILER_API_KEY = \"MTCoW3CI3wRY7K9lPnAI\";\n\nconst getCityCountry = async (coordinates) => {\n  if (!coordinates) return \"\";\n  const [lon, lat] = coordinates.split(',').map(c => c.trim());\n  try {\n    const response = await fetch(\n      `https://api.maptiler.com/geocoding/${lon},${lat}.json?key=${MAPTILER_API_KEY}&language=en`\n    );\n    const data = await response.json();\n    if (data.features && data.features.length > 0) {\n      const context = data.features[0].context || [];\n      let city = context.find(c => c.id.startsWith(\"place\"))?.text || \"\";\n      let country = context.find(c => c.id.startsWith(\"country\"))?.text || \"\";\n      // Sadece İngilizce harfler, rakamlar, boşluk ve virgül izin ver\n      city = city.replace(/[^A-Za-z0-9 ,.-]/g, \"\");\n      country = country.replace(/[^A-Za-z0-9 ,.-]/g, \"\");\n      if (city && country) return `${city}, ${country}`;\n      let placeName = data.features[0].place_name || \"\";\n      placeName = placeName.replace(/[^A-Za-z0-9 ,.-]/g, \"\");\n      return placeName;\n    }\n    return \"\";\n  } catch {\n    return \"\";\n  }\n};\nexport default function Map() {\n  const [quak, setQuak] = useState([]);\n  const [markers, setMarkers] = useState([]);\n  \n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await axios.get('https://quakify.mcskn.com/backend/api.php');\n        setQuak(response.data);\n      } catch (error) {\n        console.error('Error fetching data:', error);\n      }\n    };\n    const fetchLocations = async () => {\n      const locs = {};\n      await Promise.all(\n        quak.map(async (quake) => {\n          if (quake.coordinates) {\n            locs[quake.id] = await getCityCountry(quake.coordinates);\n          }\n        })\n      );\n      setLocations(locs);\n    };\n    if (quak.length > 0) fetchLocations();\n    fetchData();\n    \n  }, [quak]);\n  \n  const mapContainer = useRef(null);  \n  const ist = { lng: 28.97709, lat: 41.011467 };\n  const [zoom] = useState(1.5);\n\n  maptilersdk.config.apiKey = \"MTCoW3CI3wRY7K9lPnAI\";\n\n  useEffect(() => {\n    const map = new maptilersdk.Map({\n      container: mapContainer.current,\n      style: \"https://api.maptiler.com/maps/b89836a1-3239-4824-bf17-5aef32dc5664/style.json?key=MTCoW3CI3wRY7K9lPnAI\",\n      center: [ist.lng, ist.lat],\n      zoom: zoom,\n    });\n    \n    const newMarkers = quak.map(marker => {\n      const child = document.createElement(\"div\");\n      child.className = \"marker\"; \n      child.textContent = marker.magnitude;\n      child.style.textAlign = \"center\";\n      child.style.margin = \"auto\";\n      child.style.paddingTop = 22 + \"px\";\n      child.style.color = \"white\";\n      child.style.fontFamily = \"inter\";\n      child.style.fontSize = \"15px\";\n      child.style.alignItems = \"center\";\n      \n      if (marker.magnitude < 5) {\n        setMarkerStyle(child, \"https://quakify.mcskn.com/Point.png\", 20);\n      } else if (marker.magnitude >= 5 && marker.magnitude < 7) {\n        setMarkerStyle(child, \"https://quakify.mcskn.com/Point.png\", 45, 13, \"12px\");\n      } else {\n        setMarkerStyle(child, \"https://quakify.mcskn.com/Point.png\", 65);\n      }\n      \n      child.addEventListener(\"mouseover\", function () {\n        document.getElementById(\"info\").innerHTML =\n          locations[quake.id] ? locations[quake.id] : \"Yükleniyor...\"+\n          \"    /    \" +\n          marker.magnitude +\n          \"   /   \" +\n          marker.depth +\n          \"km\";\n      });\n      \n      child.addEventListener(\"mouseleave\", function () {\n        document.getElementById(\"info\").innerHTML = \"\";\n      });\n\n      const newMarker = new maptilersdk.Marker({ element: child })\n        .setLngLat(marker.coordinates.split(\",\"))\n        .addTo(map);\n      \n      return newMarker;\n    });\n\n    setMarkers(newMarkers);\n\n    return () => {\n      map.remove(); \n    };\n  }, [ist.lng, ist.lat, zoom, quak]);\n\n  const setMarkerStyle = (child, backgroundImage, width, paddingTop = 22, fontSize = \"15px\") => {\n    child.style.backgroundImage = `url(${backgroundImage})`;\n    child.style.width = `${width}px`;\n    child.style.height = `${width}px`;\n    child.style.paddingTop = `${paddingTop}px`;\n    child.style.fontSize = fontSize;\n  };\n\n  return (\n    <div className=\"map-wrap\">\n      <div id=\"info\" className=\"w-60 left-2 h-8  text-white inter-light mt-1 fixed z-20\"></div>\n      <div ref={mapContainer} className=\"map\" />\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}