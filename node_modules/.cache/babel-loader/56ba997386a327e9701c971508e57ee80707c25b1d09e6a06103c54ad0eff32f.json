{"ast":null,"code":"import React,{useRef,useEffect,useState}from\"react\";import*as maptilersdk from\"@maptiler/sdk\";import\"@maptiler/sdk/dist/maptiler-sdk.css\";import\"./map.css\";import axios from'axios';import geojson from'./quakes.json';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MAPTILER_API_KEY=\"MTCoW3CI3wRY7K9lPnAI\";async function getCityCountryFromCoords(lng,lat){const url=\"https://api.maptiler.com/geocoding/\".concat(lng,\",\").concat(lat,\".json?key=\").concat(MAPTILER_API_KEY);try{const res=await fetch(url);const data=await res.json();let city=\"\";let country=\"\";if(data.features&&data.features.length>0){for(const feat of data.features){if(!city&&feat.place_type.includes(\"place\"))city=feat.text;if(!country&&feat.place_type.includes(\"country\"))country=feat.text;}}return{city,country};}catch(e){return{city:\"\",country:\"\"};}}export default function Map(){const[quak,setQuak]=useState([]);const[markers,setMarkers]=useState([]);useEffect(()=>{const fetchData=async()=>{try{const response=await axios.get('/quakify/backend/api.php');// Koordinattan şehir ve ülke bilgisini ekle\nconst enriched=await Promise.all(response.data.map(async marker=>{let[lng,lat]=marker.coordinates.split(\",\").map(Number);const{city,country}=await getCityCountryFromCoords(lng,lat);return{...marker,city,country};}));setQuak(enriched);}catch(error){console.error('Error fetching data:',error);}};fetchData();},[]);const mapContainer=useRef(null);const ist={lng:28.97709,lat:41.011467};const[zoom]=useState(1.5);maptilersdk.config.apiKey=MAPTILER_API_KEY;useEffect(()=>{const map=new maptilersdk.Map({container:mapContainer.current,style:\"https://api.maptiler.com/maps/b89836a1-3239-4824-bf17-5aef32dc5664/style.json?key=\".concat(MAPTILER_API_KEY),center:[ist.lng,ist.lat],zoom:zoom});const newMarkers=quak.map(marker=>{const child=document.createElement(\"div\");child.className=\"marker\";child.textContent=marker.magnitude;child.style.textAlign=\"center\";child.style.margin=\"auto\";child.style.paddingTop=22+\"px\";child.style.color=\"white\";child.style.fontFamily=\"inter\";child.style.fontSize=\"15px\";child.style.alignItems=\"center\";if(marker.magnitude<5){setMarkerStyle(child,\"http://blog.mlickn.com.tr/images/less.png\",20);}else if(marker.magnitude>=5&&marker.magnitude<7){setMarkerStyle(child,\"http://blog.mlickn.com.tr/images/middle.png\",45,13,\"12px\");}else{setMarkerStyle(child,\"http://blog.mlickn.com.tr/images/high.png\",65);}child.addEventListener(\"mouseover\",function(){document.getElementById(\"info\").innerHTML=(marker.city||\"\")+(marker.country?\", \"+marker.country:\"\")+\" / \"+marker.magnitude+\" / \"+marker.depth+\"km\";});child.addEventListener(\"mouseleave\",function(){document.getElementById(\"info\").innerHTML=\"\";});const newMarker=new maptilersdk.Marker({element:child}).setLngLat(marker.coordinates.split(\",\")).addTo(map);return newMarker;});setMarkers(newMarkers);return()=>{map.remove();};},[ist.lng,ist.lat,zoom,quak]);const setMarkerStyle=function(child,backgroundImage,width){let paddingTop=arguments.length>3&&arguments[3]!==undefined?arguments[3]:22;let fontSize=arguments.length>4&&arguments[4]!==undefined?arguments[4]:\"15px\";child.style.backgroundImage=\"url(\".concat(backgroundImage,\")\");child.style.width=\"\".concat(width,\"px\");child.style.height=\"\".concat(width,\"px\");child.style.paddingTop=\"\".concat(paddingTop,\"px\");child.style.fontSize=fontSize;};return/*#__PURE__*/_jsxs(\"div\",{className:\"map-wrap\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"info\",className:\"w-60 left-2 h-8  text-white inter-light mt-1 fixed z-20\"}),/*#__PURE__*/_jsx(\"div\",{ref:mapContainer,className:\"map\"})]});}","map":{"version":3,"names":["React","useRef","useEffect","useState","maptilersdk","axios","geojson","jsx","_jsx","jsxs","_jsxs","MAPTILER_API_KEY","getCityCountryFromCoords","lng","lat","url","concat","res","fetch","data","json","city","country","features","length","feat","place_type","includes","text","e","Map","quak","setQuak","markers","setMarkers","fetchData","response","get","enriched","Promise","all","map","marker","coordinates","split","Number","error","console","mapContainer","ist","zoom","config","apiKey","container","current","style","center","newMarkers","child","document","createElement","className","textContent","magnitude","textAlign","margin","paddingTop","color","fontFamily","fontSize","alignItems","setMarkerStyle","addEventListener","getElementById","innerHTML","depth","newMarker","Marker","element","setLngLat","addTo","remove","backgroundImage","width","arguments","undefined","height","children","id","ref"],"sources":["C:/Users/bain/Desktop/Quakify-main/quakifyapp/src/components/Map.jsx"],"sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\nimport * as maptilersdk from \"@maptiler/sdk\";\nimport \"@maptiler/sdk/dist/maptiler-sdk.css\";\nimport \"./map.css\";\nimport axios from 'axios';\nimport geojson from './quakes.json';\n\nconst MAPTILER_API_KEY = \"MTCoW3CI3wRY7K9lPnAI\";\n\nasync function getCityCountryFromCoords(lng, lat) {\n  const url = `https://api.maptiler.com/geocoding/${lng},${lat}.json?key=${MAPTILER_API_KEY}`;\n  try {\n    const res = await fetch(url);\n    const data = await res.json();\n    let city = \"\";\n    let country = \"\";\n    if (data.features && data.features.length > 0) {\n      for (const feat of data.features) {\n        if (!city && feat.place_type.includes(\"place\")) city = feat.text;\n        if (!country && feat.place_type.includes(\"country\")) country = feat.text;\n      }\n    }\n    return { city, country };\n  } catch (e) {\n    return { city: \"\", country: \"\" };\n  }\n}\n\nexport default function Map() {\n  const [quak, setQuak] = useState([]);\n  const [markers, setMarkers] = useState([]);\n  \n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await axios.get('/quakify/backend/api.php');\n        // Koordinattan şehir ve ülke bilgisini ekle\n        const enriched = await Promise.all(response.data.map(async (marker) => {\n          let [lng, lat] = marker.coordinates.split(\",\").map(Number);\n          const { city, country } = await getCityCountryFromCoords(lng, lat);\n          return { ...marker, city, country };\n        }));\n        setQuak(enriched);\n      } catch (error) {\n        console.error('Error fetching data:', error);\n      }\n    };\n    fetchData();\n  }, []);\n  \n  const mapContainer = useRef(null);  \n  const ist = { lng: 28.97709, lat: 41.011467 };\n  const [zoom] = useState(1.5);\n\n  maptilersdk.config.apiKey = MAPTILER_API_KEY;\n\n  useEffect(() => {\n    const map = new maptilersdk.Map({\n      container: mapContainer.current,\n      style: `https://api.maptiler.com/maps/b89836a1-3239-4824-bf17-5aef32dc5664/style.json?key=${MAPTILER_API_KEY}`,\n      center: [ist.lng, ist.lat],\n      zoom: zoom,\n    });\n    \n    const newMarkers = quak.map(marker => {\n      const child = document.createElement(\"div\");\n      child.className = \"marker\"; \n      child.textContent = marker.magnitude;\n      child.style.textAlign = \"center\";\n      child.style.margin = \"auto\";\n      child.style.paddingTop = 22 + \"px\";\n      child.style.color = \"white\";\n      child.style.fontFamily = \"inter\";\n      child.style.fontSize = \"15px\";\n      child.style.alignItems = \"center\";\n      \n      if (marker.magnitude < 5) {\n        setMarkerStyle(child, \"http://blog.mlickn.com.tr/images/less.png\", 20);\n      } else if (marker.magnitude >= 5 && marker.magnitude < 7) {\n        setMarkerStyle(child, \"http://blog.mlickn.com.tr/images/middle.png\", 45, 13, \"12px\");\n      } else {\n        setMarkerStyle(child, \"http://blog.mlickn.com.tr/images/high.png\", 65);\n      }\n      \n      child.addEventListener(\"mouseover\", function () {\n        document.getElementById(\"info\").innerHTML =\n          (marker.city || \"\") + (marker.country ? \", \" + marker.country : \"\") +\n          \" / \" + marker.magnitude +\n          \" / \" + marker.depth +\n          \"km\";\n      });\n      \n      child.addEventListener(\"mouseleave\", function () {\n        document.getElementById(\"info\").innerHTML = \"\";\n      });\n\n      const newMarker = new maptilersdk.Marker({ element: child })\n        .setLngLat(marker.coordinates.split(\",\"))\n        .addTo(map);\n      \n      return newMarker;\n    });\n\n    setMarkers(newMarkers);\n\n    return () => {\n      map.remove(); \n    };\n  }, [ist.lng, ist.lat, zoom, quak]);\n\n  const setMarkerStyle = (child, backgroundImage, width, paddingTop = 22, fontSize = \"15px\") => {\n    child.style.backgroundImage = `url(${backgroundImage})`;\n    child.style.width = `${width}px`;\n    child.style.height = `${width}px`;\n    child.style.paddingTop = `${paddingTop}px`;\n    child.style.fontSize = fontSize;\n  };\n\n  return (\n    <div className=\"map-wrap\">\n      <div id=\"info\" className=\"w-60 left-2 h-8  text-white inter-light mt-1 fixed z-20\"></div>\n      <div ref={mapContainer} className=\"map\" />\n    </div>\n  );\n}\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,MAAM,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC1D,MAAO,GAAK,CAAAC,WAAW,KAAM,eAAe,CAC5C,MAAO,qCAAqC,CAC5C,MAAO,WAAW,CAClB,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,OAAO,KAAM,eAAe,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEpC,KAAM,CAAAC,gBAAgB,CAAG,sBAAsB,CAE/C,cAAe,CAAAC,wBAAwBA,CAACC,GAAG,CAAEC,GAAG,CAAE,CAChD,KAAM,CAAAC,GAAG,uCAAAC,MAAA,CAAyCH,GAAG,MAAAG,MAAA,CAAIF,GAAG,eAAAE,MAAA,CAAaL,gBAAgB,CAAE,CAC3F,GAAI,CACF,KAAM,CAAAM,GAAG,CAAG,KAAM,CAAAC,KAAK,CAACH,GAAG,CAAC,CAC5B,KAAM,CAAAI,IAAI,CAAG,KAAM,CAAAF,GAAG,CAACG,IAAI,CAAC,CAAC,CAC7B,GAAI,CAAAC,IAAI,CAAG,EAAE,CACb,GAAI,CAAAC,OAAO,CAAG,EAAE,CAChB,GAAIH,IAAI,CAACI,QAAQ,EAAIJ,IAAI,CAACI,QAAQ,CAACC,MAAM,CAAG,CAAC,CAAE,CAC7C,IAAK,KAAM,CAAAC,IAAI,GAAI,CAAAN,IAAI,CAACI,QAAQ,CAAE,CAChC,GAAI,CAACF,IAAI,EAAII,IAAI,CAACC,UAAU,CAACC,QAAQ,CAAC,OAAO,CAAC,CAAEN,IAAI,CAAGI,IAAI,CAACG,IAAI,CAChE,GAAI,CAACN,OAAO,EAAIG,IAAI,CAACC,UAAU,CAACC,QAAQ,CAAC,SAAS,CAAC,CAAEL,OAAO,CAAGG,IAAI,CAACG,IAAI,CAC1E,CACF,CACA,MAAO,CAAEP,IAAI,CAAEC,OAAQ,CAAC,CAC1B,CAAE,MAAOO,CAAC,CAAE,CACV,MAAO,CAAER,IAAI,CAAE,EAAE,CAAEC,OAAO,CAAE,EAAG,CAAC,CAClC,CACF,CAEA,cAAe,SAAS,CAAAQ,GAAGA,CAAA,CAAG,CAC5B,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAG7B,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAAC8B,OAAO,CAAEC,UAAU,CAAC,CAAG/B,QAAQ,CAAC,EAAE,CAAC,CAE1CD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAiC,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAA/B,KAAK,CAACgC,GAAG,CAAC,0BAA0B,CAAC,CAC5D;AACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,OAAO,CAACC,GAAG,CAACJ,QAAQ,CAACjB,IAAI,CAACsB,GAAG,CAAC,KAAO,CAAAC,MAAM,EAAK,CACrE,GAAI,CAAC7B,GAAG,CAAEC,GAAG,CAAC,CAAG4B,MAAM,CAACC,WAAW,CAACC,KAAK,CAAC,GAAG,CAAC,CAACH,GAAG,CAACI,MAAM,CAAC,CAC1D,KAAM,CAAExB,IAAI,CAAEC,OAAQ,CAAC,CAAG,KAAM,CAAAV,wBAAwB,CAACC,GAAG,CAAEC,GAAG,CAAC,CAClE,MAAO,CAAE,GAAG4B,MAAM,CAAErB,IAAI,CAAEC,OAAQ,CAAC,CACrC,CAAC,CAAC,CAAC,CACHU,OAAO,CAACM,QAAQ,CAAC,CACnB,CAAE,MAAOQ,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAC9C,CACF,CAAC,CACDX,SAAS,CAAC,CAAC,CACb,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAa,YAAY,CAAG/C,MAAM,CAAC,IAAI,CAAC,CACjC,KAAM,CAAAgD,GAAG,CAAG,CAAEpC,GAAG,CAAE,QAAQ,CAAEC,GAAG,CAAE,SAAU,CAAC,CAC7C,KAAM,CAACoC,IAAI,CAAC,CAAG/C,QAAQ,CAAC,GAAG,CAAC,CAE5BC,WAAW,CAAC+C,MAAM,CAACC,MAAM,CAAGzC,gBAAgB,CAE5CT,SAAS,CAAC,IAAM,CACd,KAAM,CAAAuC,GAAG,CAAG,GAAI,CAAArC,WAAW,CAAC0B,GAAG,CAAC,CAC9BuB,SAAS,CAAEL,YAAY,CAACM,OAAO,CAC/BC,KAAK,sFAAAvC,MAAA,CAAuFL,gBAAgB,CAAE,CAC9G6C,MAAM,CAAE,CAACP,GAAG,CAACpC,GAAG,CAAEoC,GAAG,CAACnC,GAAG,CAAC,CAC1BoC,IAAI,CAAEA,IACR,CAAC,CAAC,CAEF,KAAM,CAAAO,UAAU,CAAG1B,IAAI,CAACU,GAAG,CAACC,MAAM,EAAI,CACpC,KAAM,CAAAgB,KAAK,CAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC,CAC3CF,KAAK,CAACG,SAAS,CAAG,QAAQ,CAC1BH,KAAK,CAACI,WAAW,CAAGpB,MAAM,CAACqB,SAAS,CACpCL,KAAK,CAACH,KAAK,CAACS,SAAS,CAAG,QAAQ,CAChCN,KAAK,CAACH,KAAK,CAACU,MAAM,CAAG,MAAM,CAC3BP,KAAK,CAACH,KAAK,CAACW,UAAU,CAAG,EAAE,CAAG,IAAI,CAClCR,KAAK,CAACH,KAAK,CAACY,KAAK,CAAG,OAAO,CAC3BT,KAAK,CAACH,KAAK,CAACa,UAAU,CAAG,OAAO,CAChCV,KAAK,CAACH,KAAK,CAACc,QAAQ,CAAG,MAAM,CAC7BX,KAAK,CAACH,KAAK,CAACe,UAAU,CAAG,QAAQ,CAEjC,GAAI5B,MAAM,CAACqB,SAAS,CAAG,CAAC,CAAE,CACxBQ,cAAc,CAACb,KAAK,CAAE,2CAA2C,CAAE,EAAE,CAAC,CACxE,CAAC,IAAM,IAAIhB,MAAM,CAACqB,SAAS,EAAI,CAAC,EAAIrB,MAAM,CAACqB,SAAS,CAAG,CAAC,CAAE,CACxDQ,cAAc,CAACb,KAAK,CAAE,6CAA6C,CAAE,EAAE,CAAE,EAAE,CAAE,MAAM,CAAC,CACtF,CAAC,IAAM,CACLa,cAAc,CAACb,KAAK,CAAE,2CAA2C,CAAE,EAAE,CAAC,CACxE,CAEAA,KAAK,CAACc,gBAAgB,CAAC,WAAW,CAAE,UAAY,CAC9Cb,QAAQ,CAACc,cAAc,CAAC,MAAM,CAAC,CAACC,SAAS,CACvC,CAAChC,MAAM,CAACrB,IAAI,EAAI,EAAE,GAAKqB,MAAM,CAACpB,OAAO,CAAG,IAAI,CAAGoB,MAAM,CAACpB,OAAO,CAAG,EAAE,CAAC,CACnE,KAAK,CAAGoB,MAAM,CAACqB,SAAS,CACxB,KAAK,CAAGrB,MAAM,CAACiC,KAAK,CACpB,IAAI,CACR,CAAC,CAAC,CAEFjB,KAAK,CAACc,gBAAgB,CAAC,YAAY,CAAE,UAAY,CAC/Cb,QAAQ,CAACc,cAAc,CAAC,MAAM,CAAC,CAACC,SAAS,CAAG,EAAE,CAChD,CAAC,CAAC,CAEF,KAAM,CAAAE,SAAS,CAAG,GAAI,CAAAxE,WAAW,CAACyE,MAAM,CAAC,CAAEC,OAAO,CAAEpB,KAAM,CAAC,CAAC,CACzDqB,SAAS,CAACrC,MAAM,CAACC,WAAW,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CACxCoC,KAAK,CAACvC,GAAG,CAAC,CAEb,MAAO,CAAAmC,SAAS,CAClB,CAAC,CAAC,CAEF1C,UAAU,CAACuB,UAAU,CAAC,CAEtB,MAAO,IAAM,CACXhB,GAAG,CAACwC,MAAM,CAAC,CAAC,CACd,CAAC,CACH,CAAC,CAAE,CAAChC,GAAG,CAACpC,GAAG,CAAEoC,GAAG,CAACnC,GAAG,CAAEoC,IAAI,CAAEnB,IAAI,CAAC,CAAC,CAElC,KAAM,CAAAwC,cAAc,CAAG,QAAAA,CAACb,KAAK,CAAEwB,eAAe,CAAEC,KAAK,CAAyC,IAAvC,CAAAjB,UAAU,CAAAkB,SAAA,CAAA5D,MAAA,IAAA4D,SAAA,MAAAC,SAAA,CAAAD,SAAA,IAAG,EAAE,IAAE,CAAAf,QAAQ,CAAAe,SAAA,CAAA5D,MAAA,IAAA4D,SAAA,MAAAC,SAAA,CAAAD,SAAA,IAAG,MAAM,CACvF1B,KAAK,CAACH,KAAK,CAAC2B,eAAe,QAAAlE,MAAA,CAAUkE,eAAe,KAAG,CACvDxB,KAAK,CAACH,KAAK,CAAC4B,KAAK,IAAAnE,MAAA,CAAMmE,KAAK,MAAI,CAChCzB,KAAK,CAACH,KAAK,CAAC+B,MAAM,IAAAtE,MAAA,CAAMmE,KAAK,MAAI,CACjCzB,KAAK,CAACH,KAAK,CAACW,UAAU,IAAAlD,MAAA,CAAMkD,UAAU,MAAI,CAC1CR,KAAK,CAACH,KAAK,CAACc,QAAQ,CAAGA,QAAQ,CACjC,CAAC,CAED,mBACE3D,KAAA,QAAKmD,SAAS,CAAC,UAAU,CAAA0B,QAAA,eACvB/E,IAAA,QAAKgF,EAAE,CAAC,MAAM,CAAC3B,SAAS,CAAC,yDAAyD,CAAM,CAAC,cACzFrD,IAAA,QAAKiF,GAAG,CAAEzC,YAAa,CAACa,SAAS,CAAC,KAAK,CAAE,CAAC,EACvC,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}